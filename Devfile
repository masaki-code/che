metadata:
  name: wksp-62k5
projects:
  - name: masaki-code-che
    source:
      location: 'https://github.com/masaki-code/che.git'
      type: git
      branch: php
attributes:
  persistVolumes: 'false'
components:
  - mountSources: true
    endpoints:
      - name: 8080/tcp
        port: 8080
    memoryLimit: 512Mi
    type: dockerimage
    volumes:
      - name: composer
        containerPath: /home/user/.composer
    alias: php
    image: 'quay.io/eclipse/che-php-7:nightly'
apiVersion: 1.0.0
commands:
  - name: composer install
    actions:
      - workdir: '${CHE_PROJECTS_ROOT}/masaki-code-che'
        type: exec
        command: composer install
        component: php
  - name: composer update
    actions:
      - workdir: '${CHE_PROJECTS_ROOT}/masaki-code-che'
        type: exec
        command: composer update
        component: php
  - name: phpunit
    actions:
      - workdir: '${CHE_PROJECTS_ROOT}/masaki-code-che'
        type: exec
        command: vendor/bin/phpunit tests/
        component: php
